---
import { SideBarMenu } from "@comp/SideBarMenu";
import { UserCard } from "@elements/UserCard";

const routes = [
  { name: "Dashboard", path: "/" },
  { name: "Materiais", path: "/materiais/", permissionNeeded: 2 },
  { name: "Fornecedores", path: "/fornecedores/", permissionNeeded: 1 },
  { name: "Compras", path: "/compras/", permissionNeeded: 3 },
  { name: "Usuários", path: "/usuarios/", permissionNeeded: 0 },
  { name: "Clientes", path: "/clientes/", permissionNeeded: 4 },
  { name: "Orçamentos", path: "/orcamentos/", permissionNeeded: 5 },
  { name: "Ordens", path: "/ordens/", permissionNeeded: 6 },
  { name: "Pedidos", path: "/pedidos/", permissionNeeded: 7 },
  { name: "Serviços", path: "/servicos/", permissionNeeded: 8 },
];
---

<aside
  id="sideBar"
  class="bg-slate-800 p-4 gap-3 flex md:flex-col navBar md:fixed md:h-full not-md:w-full not-md:overflow-scroll"
  transition:persist="sideBar"
>
  <UserCard client:load />
  <SideBarMenu routes={routes} client:load />
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const role = localStorage.getItem("apiRole");
      const permissions = localStorage.getItem("apiPermissions");
      if (role == undefined || permissions == undefined) {
        document.location.href = "login/";
      }
    });
  </script>
</aside>
